import{d as Q,bk as X,bl as Y,bm as Z,e as b,b as ee,bx as ae,bn as oe,O as le,by as B,_ as ne,bz as se,F as te,r as C,o as f,f as h,g as o,W as $,aa as F,t as ue,c as re,H as y,ad as q,j as u,I as g,l as ie,a8 as L,L as G,J as de,K as pe}from"./75bbe58a.js";import{n as ce,I as R,q as me,i as ve,a as fe,v as ge,C as be,w as Ce,x as he,y as _e,S as we}from"./index.js";import{E as ye}from"./ee1213a1.js";import{E as Fe}from"./3f4c5204.js";import"./04ee1aa4.js";const D=["#5140fe","#ff7301","#0ab700","#ec2b1c","#000000","#1e6fff","#EE0FEA","transparent"],Ie=Q({name:"UserApp",components:{ElForm:X,ElFormItem:Y,ElInput:Z,EtabUpload:ye,ElColorPicker:Fe},props:{width:{type:Number,default:570},app:{type:Object,default:()=>({icon:null,name:null,type:null,appName:null,code:null,url:null,bg:"transparent"})}},setup(e){const n=ce(),p=b(D.length-1),U=b(1),w=b(!1),E=b(),k=b(),a=b({appName:null,url:null,type:null,icon:null,bg:"transparent",isHerf:!0}),_=ee({appName:[{required:!0,validator:ae,message:"Please Enter The Navigation Name",trigger:"blur"}],url:[{required:!0,validator:oe,trigger:"blur"}],icon:[{required:!0,message:"Please Enter The IconURL",trigger:"blur"}]}),t=b([...D]),N=()=>{E.value.validate(()=>{if(a.value.url){const l=new URL(a.value.url).origin;a.value.icon=me(l,64)}})},V=()=>{t.value.length<D.length+1?t.value.push(a.value.bg):t.value[t.value.length-1]=a.value.bg,p.value=t.value.length-1},A=()=>{k.value.onView(a.value.icon)},s=l=>{U.value=l,_.icon[0].required=l===1},i=async l=>{n.validateLogin()||(a.value.bg=await se(l),a.value.icon=l,V())},S=async(l,d)=>{const r=((m,v)=>{let z=-1,P=-1;return m.find((J,K)=>J.list.find((T,W)=>(T.data.code===v&&(z=K,P=W),T.data.code===v))),{gIndex:z,lIndex:P}})(l,e.app.code);if(r.gIndex!==-1&&r.lIndex!==-1){const m=l[r.gIndex].list[r.lIndex];let v=null;d=="pic"?v=a.value.bg:v=t.value[p.value]?t.value[p.value]:a.value.bg,l[r.gIndex].list[r.lIndex]={...m,data:{...m.data,url:a.value.url,icon:a.value.icon,appName:a.value.appName,input:B(a.value.appName),bg:v}},window.appStorage.onPush(G.cache,{icons:l})}},j=async(l,d)=>{const c=l.findIndex(v=>v.id==n.$state.appGroupId);let r=null,m=null;d=="pic"?(m=a.value.bg,r=a.value.icon):(r="",m=t.value[p.value]?t.value[p.value]:a.value.bg),l[c].list.push({name:fe.EtabApp,size:ge.min,class:be.Min,mens:{comName:Ce.iconMen,sizes:he},data:{code:new Date().getTime(),type:R.icon,icon:r,input:B(a.value.appName),appName:a.value.appName,url:a.value.url,bg:m}}),window.appStorage.onPush(G.cache,{icons:l})},H=()=>{a.value.input=B(a.value.appName)},x=async()=>{const l=_e(a.value.icon,new Date().getTime().toString()+".png");return await we.upload({fileName:l.name,file:l})},M=async l=>{E.value.validate(async d=>{if(d)try{if(w.value=!0,a.value.icon.indexOf("http")==-1&&a.value.icon.indexOf("base64")!=-1){const r=await x();a.value.icon=r.data}const c=await ve.getAppIcons();e.app.code?(S(c,l),O()):(j(c,l),O()),w.value=!1}catch{w.value=!1}})},O=()=>{window.appStorage.emit(te.onClose)};return le(()=>{if(e.app.appName){const l=e.app.bg||"transparent";a.value={...e.app,input:B(e.app.appName),bg:l,isHerf:e.app.type===R.icon};const d=t.value.findIndex(c=>c===l);p.value=d!=-1?d:-1}}),{onClose:O,colors:t,selectIndex:p,taIndex:U,onChanTab:s,onSave:M,qform:a,onBeforeUpload:i,onView:A,rules:_,upload:k,formRef:E,onColor:V,loading:w,onChangeName:H,onGetPic:N}}}),I=e=>(de("data-v-6d3b67e8"),e=e(),pe(),e),Ee={class:"app-user_warp flex"},ke={class:"from-warp"},Ne={class:"input-wrapper"},Ve=I(()=>o("div",{class:"input-title"},"Navigation Name",-1)),Be={class:"input-area"},qe={key:0,class:"input-wrapper"},Ue=I(()=>o("div",{class:"input-title"},"Navigation Address",-1)),Ae={class:"input-area"},Se=F(" Get Icon "),Oe={class:"bars flex flex-between"},$e={class:"warp"},De={class:"color-wrapper"},ze=I(()=>o("div",{class:"color-title"},"Icon Color",-1)),Pe={class:"all-colo"},Te={class:"color-part-wrapper"},Le=["onClick"],Ge={class:"input-wrapper flex-end mt-30"},Re=F(" Save "),je={class:"warp"},He={class:"color-wrapper"},xe=I(()=>o("div",{class:"color-title"},"Icon Color",-1)),Me={class:"all-colo mb-10"},Je={class:"color-part-wrapper"},Ke=["onClick"],We={class:"input-wrapper"},Qe=I(()=>o("div",{class:"input-title"},"Custom Icon",-1)),Xe={class:"input-area flex"},Ye=F(" Upload "),Ze={class:"input-wrapper flex flex-end"},ea=F(" Save ");function aa(e,n,p,U,w,E){const k=C("el-image"),a=C("el-input"),_=C("el-form-item"),t=C("EtabBt"),N=C("ElColorPicker"),V=C("EtabUpload"),A=C("el-form");return f(),h("section",Ee,[o("div",{class:y(["flex head-img flex-cc radius",{border:e.colors[e.selectIndex]==="transparent"}]),onClick:n[0]||(n[0]=(...s)=>e.onView&&e.onView(...s)),style:q({background:e.colors[e.selectIndex]?e.colors[e.selectIndex]:e.qform.bg})},[e.taIndex==0?(f(),h($,{key:0},[F(ue(e.qform.input),1)],64)):(f(),re(k,{key:1,class:"radius",src:e.qform.icon,fit:"cover"},null,8,["src"]))],6),o("div",ke,[u(A,{ref:"formRef",rules:e.rules,model:e.qform},{default:g(()=>[o("div",Ne,[Ve,o("div",Be,[u(_,{prop:"appName"},{default:g(()=>[u(a,{type:"input",onChange:e.onChangeName,placeholder:"Please Enter The Navigation Name",modelValue:e.qform.appName,"onUpdate:modelValue":n[1]||(n[1]=s=>e.qform.appName=s)},null,8,["onChange","modelValue"])]),_:1})])]),e.qform.isHerf?(f(),h("div",qe,[Ue,o("div",Ae,[u(_,{prop:"url"},{default:g(()=>[u(a,{style:{width:"83%"},type:"input",placeholder:"Please EnterNavigation Address",clearable:"",modelValue:e.qform.url,"onUpdate:modelValue":n[2]||(n[2]=s=>e.qform.url=s)},null,8,["modelValue"]),u(t,{class:"ml-20",size:"large",type:"primary",onOnClick:e.onGetPic},{default:g(()=>[Se]),_:1},8,["onOnClick"])]),_:1})])])):ie("",!0),o("div",Oe,[o("div",{class:y(["bar",[e.taIndex===1?"bar-s":""]]),onClick:n[3]||(n[3]=s=>e.onChanTab(1))}," Picture Icon ",2),o("div",{class:y(["bar",[e.taIndex===0?"bar-s":""]]),onClick:n[4]||(n[4]=s=>e.onChanTab(0))}," Text Icon ",2)]),o("div",{class:"tabs",style:q({transform:`translate3d(-${e.taIndex*(100/2)}%, 0px, 0px)`})},[o("div",$e,[o("div",De,[ze,o("div",Pe,[o("div",Te,[(f(!0),h($,null,L(e.colors,(s,i)=>(f(),h("div",{class:y(["color-part pointer flex flex-between radius",{"select-color":e.selectIndex==i}]),onClick:S=>e.selectIndex=i,key:i,style:q({background:s})},null,14,Le))),128)),u(N,{modelValue:e.qform.bg,"onUpdate:modelValue":n[5]||(n[5]=s=>e.qform.bg=s),onChange:e.onColor},null,8,["modelValue","onChange"])])])]),o("div",Ge,[u(t,{class:"ml-20",type:"primary",size:"large",onOnClick:n[6]||(n[6]=s=>e.onSave("text"))},{default:g(()=>[Re]),_:1})])]),o("div",je,[o("div",He,[xe,o("div",Me,[o("div",Je,[(f(!0),h($,null,L(e.colors,(s,i)=>(f(),h("div",{class:y(["color-part pointer flex flex-between radius",{"select-color":e.selectIndex==i}]),onClick:S=>e.selectIndex=i,key:i,style:q({background:s})},null,14,Ke))),128)),u(N,{modelValue:e.qform.bg,"onUpdate:modelValue":n[7]||(n[7]=s=>e.qform.bg=s),onChange:e.onColor},null,8,["modelValue","onChange"])])])]),o("div",We,[Qe,o("div",Xe,[u(_,{prop:"icon",style:{width:"65%"}},{default:g(()=>[u(a,{clearable:"",type:"input",placeholder:"Please Enter The IconURL",modelValue:e.qform.icon,"onUpdate:modelValue":n[8]||(n[8]=s=>e.qform.icon=s)},null,8,["modelValue"])]),_:1}),u(V,{class:"ml-10",accept:"image/*",ref:"upload",onOnChange:e.onBeforeUpload},{default:g(()=>[Ye]),_:1},8,["onOnChange"])])]),o("div",Ze,[u(t,{loading:e.loading,class:"ml-20",type:"primary",size:"large",onOnClick:n[9]||(n[9]=s=>e.onSave("pic"))},{default:g(()=>[ea]),_:1},8,["loading"])])])],4)]),_:1},8,["rules","model"])])])}var ra=ne(Ie,[["render",aa],["__scopeId","data-v-6d3b67e8"]]);export{ra as U};
