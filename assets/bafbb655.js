import{by as u,L as p,bz as m}from"./75bbe58a.js";import{a as I,v as C,C as w,w as x,O as h,I as d}from"./index.js";const A=async(e,n,o,s)=>({name:I.EtabApp,size:C.min,class:w.Min,mens:{comName:x.iconMen,sizes:h},data:e=="new"?{code:n,type:d.icon,icon:o.logo,appName:s,url:o.url,bg:await m(o.logo)}:{...o,type:d.icon}}),b=(e,n)=>{let o=-1,s=-1;const t=r=>r.list.findIndex(c=>n==c.data.code),i=!1;return e.findIndex((r,c)=>(s=t(r),s!=-1&&!i?(o=c,!0):!1)),{findex:o,findIndex:s}},g=(e,n)=>e.findIndex(o=>n==o.id),N=async(e,n,o,s)=>{try{let t=null,i=!1;s==="app"?t=n.data.code:t=s=="new"?`code-${new Date().getTime()}`:n.code;const r=u(n.title),{findex:c,findIndex:l}=b(e,t);if(c!=-1)e[c].list.splice(l,1),i=!1;else{const a=g(e,o);if(s==="app")e[a].list.push(n),i=!0;else{const f=await A(s,t,n||{},r);e[a].list.push(f),i=!0}}return window.appStorage.onPush(p.cache,{icons:e}),i}catch{return!1}};export{N as A};
